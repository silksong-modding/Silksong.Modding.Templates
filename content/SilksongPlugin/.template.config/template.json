{
  "$schema": "http://json.schemastore.org/template",
  "author": "BadMagic",
  "classifications": [ "Mod", "Plugin", "silksong", "BepInEx" ],
  "identity": "Silksong.Modding.Plugin",
  "name": "Silksong Modding Plugin",
  "shortName": "silksongplugin",
  "sourceName": "Silksong.Plugin.1",
  "defaultName": "SilksongMod1",
  "primaryOutputs": [
    {
      "path": "Silksong.Plugin.1.csproj"
    }
  ],
  "tags": {
    "language": "C#",
    "type": "project"
  },
  "symbols": {
    "username": {
      "type": "parameter",
      "datatype": "string",
      "isRequired": true,
      "replaces": "UserName",
      "displayName": "GitHub Username",
      "description": "Your GitHub username. Used to set the default plugin GUID and repo URLs. If you don't have a GitHub account any username will do but the pre-filled template values will be less applicable",
      "forms": {
        "global": [
          "lc"
        ]
      }
    },
    "thunderstore-username": {
      "type": "parameter",
      "datatype": "string",
      "displayName": "Thunderstore Username",
      "description": "Your Thunderstore username. Used to set the default Thunderstore namespace. If not specified, defaults to GitHub username."
    },
    "ts-or-gh-username": {
      "type": "generated",
      "generator": "coalesce",
      "parameters": {
        "sourceVariableName": "thunderstore-username",
        "fallbackVariableName": "username"
      },
      "replaces": "ThunderstoreUserName",
      "forms": {
        "global": [
          "lc"
        ]
      }
    },
    "silksong-install-path": {
      "type": "parameter",
      "datatype": "string",
      "defaultValue": "C:/Program Files (x86)/Steam/steamapps/common/Hollow Knight Silksong",
      "replaces": "SilksongInstallPath",
      "displayName": "Silksong Install Path",
      "description": "The installation path of Silksong"
    },
    "game-version": {
      "type": "parameter",
      "dataType": "choice",
      "replaces": "SilksongVersion",
      "displayName": "Game Version",
      "description": "The version of Silksong being modded. Most mods should choose latest, but mods that are specifically targeting an older version can specify that version.",
      "defaultValue": "latest",
      "choices": [
        {
          "choice": "latest",
          "description": "Automatically target the latest version of the game."
        },
        {
          "choice": "1.0.28891",
          "description": "Bugfix and balance patch. Released Oct 13 2025."
        },
        {
          "choice": "1.0.28714",
          "description": "Undocumented patch for all platforms. Contains the patch for CVE-2025-59489 on Windows and Mac. Released Sept 24 2025/patched Oct 3."
        },
        {
          "choice": "1.0.28650",
          "description": "Second real bugfix patch. Released Sept 22 2025."
        },
        {
          "choice": "1.0.28561",
          "description": "Second (less documented) bugfix and balance patch. Released Sept 12 2025."
        },
        {
          "choice": "1.0.28497",
          "description": "First bugfix and balance patch. Released Sept 12 2025."
        },
        {
          "choice": "1.0.28324",
          "description": "Initial release. Released Sept 4 2025."
        }
      ]
    },
    "polysharp": {
      "type": "parameter",
      "datatype": "bool",
      "displayName": "Enable PolySharp?",
      "description": "Whether to enable PolySharp to polyfill newer language features that do not require runtime support.",
      "defaultValue": "false"
    },
    "unity-version": {
      "type": "generated",
      "replaces": "UnityVersion",
      "generator": "switch",
      "parameters": {
        "dataType": "string",
        "cases": [
          {
            "condition": "game-version == 'latest'",
            "value": "6000.0.50"
          },
          {
            // default case. We'll worry about newer unity versions as they happen
            "condition": "",
            "value": "6000.0.50"
          }
        ]
      }
    },
    "stripped-class-name": {
      "type": "derived",
      "valueSource": "name",
      "valueTransform": "stripped_class",
      "replaces": "Plugin__1",
      // I think it's really really cool that value forms of sourceName are not applied to file names by default
      "fileRename": "Plugin__1"
    },
    "stripped-namespace-name": {
      "type": "derived",
      "valueSource": "name",
      "valueTransform": "stripped_namespace",
      "replaces": "Plugin._1"
    },
    "stripped-lower-class-name": {
      "type": "derived",
      "valueSource": "name",
      "valueTransform": "stripped_lower_class",
      "replaces": "plugin__1"
    },
    "stripped-lower-namespace-name": {
      "type": "derived",
      "valueSource": "name",
      "valueTransform": "stripped_lower_namespace",
      "replaces": "plugin._1"
    }
  },
  "forms": {
    "lc": {
      "identifier": "lowerCase"
    },
    "strip_silksong_prefix": {
      "identifier": "replace",
      "pattern": "(S|s)ilk(S|s)ong\\.?(.*)",
      "replacement": "$3"
    },
    "stripped_class": {
      "identifier": "chain",
      "steps": [ "strip_silksong_prefix", "safe_name" ]
    },
    "stripped_namespace": {
      "identifier": "chain",
      "steps": [ "strip_silksong_prefix", "safe_namespace" ]
    },
    "stripped_lower_class": {
      "identifier": "chain",
      "steps": [ "strip_silksong_prefix", "lower_safe_name" ]
    },
    "stripped_lower_namespace": {
      "identifier": "chain",
      "steps": [ "strip_silksong_prefix", "lower_safe_namespace" ]
    }
  },
  "postActions": [
    {
      "description": "Adding reference to PolySharp",
      "actionId": "B17581D1-C5C9-4489-8F0A-004BE667B814",
      "condition": "polysharp",
      "manualInstructions": [
        {
          "text": "Run `dotnet add package PolySharp`"
        }
      ],
      "args": {
        "referenceType": "package",
        "reference": "PolySharp"
      }
    },
    {
      "description": "Restore dependencies",
      "manualInstructions": [
        {
          "text": "Run `dotnet restore`"
        }
      ],
      "actionId": "210D431B-A78B-4D2F-B762-4ED3E3EA9025"
    }
  ]
}
